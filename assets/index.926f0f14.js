var e,t,o=(e,t,o)=>new Promise(((n,i)=>{var a=e=>{try{r(o.next(e))}catch(t){i(t)}},l=e=>{try{r(o.throw(e))}catch(t){i(t)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,l);r((o=o.apply(e,t)).next())}));import{u as n,_ as i}from"./useTable.81787a2e.js";import{_ as a}from"./useForm.f93bccee.js";import{af as l,a7 as r}from"./index.6a5548ea.js";import{af as s,c1 as d,B as c,N as p,Z as m,bE as u,D as f,E as b,w as x,a2 as h,F as g,u as j,a9 as y,t as w}from"./vendor.7c679a32.js";/* empty css              */import"./props.df8b9a2a.js";import"./const.ba9bd2e6.js";import"./useWindowSizeFn.bec912bd.js";import"./index.1d3e54eb.js";import"./onMountedOrActivated.51a605f4.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./dateUtil.839e4f2c.js";/* empty css              */import"./useSortable.7806d92e.js";/* empty css              *//* empty css              *//* empty css              */import"./index.1c4a88d9.js";/* empty css              */import"./download.38a3a81a.js";import"./index.3b2c921a.js";(t=e||(e={})).list="/monitor_proxy/monitor/operLog/list",t.del="/monitor_proxy/monitor/operLog/remove",t.clean="/monitor_proxy/monitor/operLog/clean";const I=t=>l.get({url:e.list,params:t},{isReturnResultResponse:!0}),v=[{title:"日志标题",dataIndex:"title"},{title:"请求方式",dataIndex:"method"},{title:"操作人员",dataIndex:"operName"},{title:"IP地址",dataIndex:"operIp"},{title:"操作地点",dataIndex:"operAddr"},{title:"客户端",dataIndex:"clientId"},{title:"请求时间",dataIndex:"executeTime"},{title:"操作状态",dataIndex:"status",width:120,customRender:({record:e})=>{const t=0==~~e.status,o=t?"正常":"异常";return s(d,{color:t?"green":"red"},(()=>o))}},{title:"操作日期",dataIndex:"operTime"}],S=[{field:"title",label:"日志标题",component:"Input",componentProps:{placeholder:"请输入日志标题"},colProps:{span:6}},{field:"operName",label:"操作人员",component:"Input",componentProps:{placeholder:"请输入操作人员"},colProps:{span:6}},{field:"status",label:"操作状态",component:"Select",componentProps:{options:[{label:"正常",value:"0"},{label:"异常",value:"1"}]},colProps:{span:6}},{field:"dateRange",label:"创建时间",component:"RangePicker",componentProps:{style:{width:"100%"},valueFormat:"YYYY-MM-DD",placeholder:["开始日期","结束日期"]},colProps:{span:6}}],R=y("删除日志"),P=y("清空日志");var T=c({setup(t){const s=p({single:!0,multiple:!0}),{createConfirm:d,createMessage:c}=r(),[y,{reload:T,clearSelectedRowKeys:_,getSelectRowKeys:k}]=n({title:"操作日志列表",api:I,rowKey:"id",columns:v,formConfig:{labelWidth:120,schemas:S,autoSubmitOnEnter:!0,fieldMapToTime:[["dateRange",["beginTime","endTime"],"YYYY-MM-DD"]]},rowSelection:{type:"checkbox"},useSearchForm:!0,showTableSetting:!0,bordered:!0,clickToRowSelect:!1,showIndexColumn:!1,tableSetting:{fullScreen:!0},actionColumn:{width:120,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:!1},handleSearchInfoFn:()=>_()});function C(e){const t=w(null==e?void 0:e.keys)||[];s.single=1!=t.length,s.multiple=!t.length}function Y(t){return o(this,null,(function*(){const n=(null==t?void 0:t.id)||k();d({iconType:"warning",title:"警告",content:`是否确认删除操作日志编号为${n}操作日志吗?`,onOk:()=>o(this,null,(function*(){yield(t=>l.delete({url:`${e.del}/${t}`}))(n),c.success("删除成功!"),F()}))})}))}function M(){return o(this,null,(function*(){d({iconType:"warning",title:"警告",content:"是否确认清空全部操作日志?",onOk:()=>o(this,null,(function*(){yield l.delete({url:e.clean}),c.success("清除成功!"),F()}))})}))}function F(){_(),T()}return(e,t)=>{const o=m("a-button"),n=u("auth");return f(),b("div",null,[x(j(i),{onRegister:j(y),onSelectionChange:C},{toolbar:h((()=>[g(x(o,{type:"primary",disabled:j(s).multiple,onClick:t[0]||(t[0]=e=>Y())},{default:h((()=>[R])),_:1},8,["disabled"]),[[n,["role_del"]]]),g(x(o,{type:"primary",onClick:t[1]||(t[1]=e=>M())},{default:h((()=>[P])),_:1},512),[[n,["operLog_del"]]])])),action:h((({record:e})=>[x(j(a),{actions:[{label:"删除",icon:"ant-design:delete-outlined",color:"error",auth:["client_del"],onClick:Y.bind(null,e)}]},null,8,["actions"])])),_:1},8,["onRegister"])])}}});export{T as default};
