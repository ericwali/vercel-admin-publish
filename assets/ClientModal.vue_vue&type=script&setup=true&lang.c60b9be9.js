var e=(e,t,s)=>new Promise(((a,o)=>{var l=e=>{try{i(s.next(e))}catch(t){o(t)}},n=e=>{try{i(s.throw(e))}catch(t){o(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,n);i((s=s.apply(e,t)).next())}));import{d as t,c as s}from"./useForm.f93bccee.js";import{af as a,aF as o}from"./index.6a5548ea.js";import{a as l,B as n}from"./index.1d3e54eb.js";import{B as i,r,u as d,D as c,_ as p,a2 as m,w as u,a1 as y}from"./vendor.7c679a32.js";const h=[{title:"客户端Id",dataIndex:"clientId",width:100},{title:"客户端密钥",dataIndex:"clientSecret",width:100},{title:"授权类型",dataIndex:"authorizedGrantTypes",width:130},{title:"授权范围",dataIndex:"scope",width:90},{title:"令牌过期秒数",dataIndex:"accessTokenValidity",width:130},{title:"令牌过期秒数",dataIndex:"refreshTokenValidity",width:130},{title:"创建时间",dataIndex:"createTime",width:100}],f=[{field:"clientId",label:"客户端编码",component:"Input",componentProps:{placeholder:"请输入客户端编码"},colProps:{span:8}},{field:"dateRange",label:"创建时间",component:"RangePicker",componentProps:{style:{width:"100%"},valueFormat:"YYYY-MM-DD",placeholder:["开始日期","结束日期"]},colProps:{span:8}}],I=[{field:"id",label:"ID",component:"Input",show:!1},{field:"clientId",label:"客户端Id",component:"Input",required:!0,colProps:{span:12}},{field:"clientSecret",label:"客户端密钥",component:"Input",required:!0,colProps:{span:12}},{field:"authorizedGrantTypes",label:"授权类型",component:"InputTextArea",required:!0,componentProps:{rows:3},colProps:{span:24}},{field:"scope",label:"授权范围",component:"Input",required:!0,colProps:{span:12}},{field:"accessTokenValidity",label:"过期秒数",component:"InputNumber",componentProps:{style:{width:"100%"},min:0},colProps:{span:12}},{field:"refreshTokenValidity",label:"刷新秒数",component:"InputNumber",componentProps:{style:{width:"100%"},min:0},colProps:{span:12}},{field:"webServerRedirectUri",label:"回调地址",component:"Input",colProps:{span:12}},{field:"additionalInformation",label:"附加说明",component:"InputTextArea",componentProps:{rows:6},colProps:{span:24}}];var v,P;(P=v||(v={})).list="/system_proxy/system/client/list",P.add="/system_proxy/system/client/save",P.get="/system_proxy/system/client",P.edit="/system_proxy/system/client/update",P.del="/system_proxy/system/client/remove",P.cache="/system_proxy/system/client/cache";const b=e=>a.get({url:v.list,params:e},{isReturnResultResponse:!0}),w=e=>a.delete({url:`${v.del}/${e}`});var x=i({emits:["success","register"],setup(i,{emit:h}){const f=r(""),[P,{resetFields:w,setFieldsValue:x,validate:g,clearValidate:_,updateSchema:R}]=t({labelWidth:100,schemas:I,showActionButtonGroup:!1,baseColProps:{span:24}}),[T,{setModalProps:k,closeModal:V}]=l(((...t)=>e(this,[...t],(function*(t={_tag:""}){var s;yield w(),yield _(),f.value=t._tag;const l=null==(s=t.record)?void 0:s.clientId,n={confirmLoading:!1};switch(yield R({field:"clientId",componentProps:{disabled:"add"!=d(f)},rules:[{required:!0,whitespace:!0,message:"请输入客户端编码"},{validator:(t,s)=>e(this,null,(function*(){var e;if(!o(s)){const t=null==(e=(yield b({clientId:s})).data)?void 0:e.filter((e=>e.clientId!=l));if((null==t?void 0:t.length)>0)return Promise.reject("该客户端编码已存在")}return Promise.resolve()})),validateTrigger:"blur"}]}),d(f)){case"add":n.title="新增客户端";break;case"edit":n.title="编辑客户端",yield x(yield(i=l,a.get({url:`${v.get}/${i}`})))}var i;k(n)}))));function j(){return e(this,null,(function*(){try{const t=yield g();switch(k({confirmLoading:!0}),d(f)){case"add":yield(e=t,a.post({url:v.add,data:e}));break;case"edit":yield(e=>a.put({url:v.edit,data:e}))(t)}V(),h("success")}finally{k({confirmLoading:!1})}var e}))}return(e,t)=>(c(),p(d(n),y(e.$attrs,{width:"720px",onRegister:d(T),onOk:j}),{default:m((()=>[u(d(s),{onRegister:d(P)},null,8,["onRegister"])])),_:1},16,["onRegister"]))}});export{x as _,h as c,w as d,b as l,f as s};
